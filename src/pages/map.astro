---
/**
 * Map View Page
 * 
 * Main page for discovering photo locations through an interactive map.
 * Public view - accessible to all users, with additional features for authenticated users.
 */

import Layout from '../layouts/Layout.astro';
import { MapSection } from '../components/map/MapSection';
import type { UserRole } from '../types';

// Get user authentication state from middleware
const session = Astro.locals.session;
const user = Astro.locals.user;

// Determine if user is authenticated and their role
const isAuthenticated = !!session && !!user;
const userRole: UserRole | null = user?.user_metadata?.role || null;

// Optional: Get initial viewport from query params or user preferences
// For now, using default viewport from MapSection
---

<Layout title="Map - Discover Photo Spots | PhotoSpot">
  <!-- Meta tags for SEO -->
  <meta name="description" content="Discover amazing photo locations on an interactive map. Filter by category, season, and time of day to find your perfect shot." slot="head" />
  <meta name="keywords" content="photo map, photography locations, photo spots, landscape photography, travel photography" slot="head" />
  
  <!-- Open Graph tags -->
  <meta property="og:title" content="Photo Map - Discover Perfect Spots" slot="head" />
  <meta property="og:description" content="Explore an interactive map of stunning photo locations shared by photographers worldwide." slot="head" />
  <meta property="og:type" content="website" slot="head" />

  <!-- Full-screen map container -->
  <div class="h-screen w-screen overflow-hidden">
    <MapSection
      client:load
      isAuthenticated={isAuthenticated}
      userRole={userRole}
    />
  </div>
</Layout>

<style>
  /* Ensure full-height layout */
  :global(html),
  :global(body) {
    height: 100%;
    overflow: hidden;
  }
</style>

